---
title: "World Happiness Report(2024) Dashboard"
author: "Aichen Rayphand"
format:
  dashboard:
    theme: Vapor 
nav-buttons: [github]
---

## Row 1

```{r}
library(tidyverse)
library(plotly)
library(janitor)
library(ggplot2)

happiness <- read_csv("data/World-happiness-report-2024.csv")
Happiness <- happiness %>%
  clean_names
```

```{r, echo=FALSE}
Happiness_region <- Happiness %>%
  group_by(regional_indicator) %>%
  summarize(mean_score = mean (ladder_score, na.rm = TRUE))

p2 <- ggplot(data = Happiness_region, aes(x =reorder(regional_indicator, mean_score), y= mean_score))+
  geom_bar(stat = "identity") +
  geom_col(fill= "Purple", color= "Black") +
  labs(
    title = "Happiness score/rate by region",
    x = "Regions",
    y = "Happiness Scores"
  ) +
  theme(axis.text.x = element_text(angle = 60, vjust = .5, hjust = 1, color= "black", family= "serif"),
        axis.title = element_text(face= "bold", family = "sans", color = "plum"),
        plot.title = element_text(size = 17, face = "bold", family = "mono", hjust= 0.5),
        panel.background = element_rect(fill= "black", color = NA),
        plot.background = element_rect(fill= "lavender", color = NA))

ggplotly(p2)


```

## World_Happiness visuals {. tabset}

### Plots

### plot 1

```{r, warning=FALSE}

#| title: "Happiness rates when there's freedom to make life choices"
p2 <- ggplot(data = Happiness,aes( x =freedom_to_make_life_choices, y = ladder_score, color= regional_indicator)) +
  geom_point(size= 2.5, alpha= 0.8) +
  geom_smooth (method= "lm",se= FALSE, color= "pink") +
  labs(title = "Happiness (ladder) scores when there's freedom to make life choices",
       x= "Free-will",
       y= "Happiness score",
       color= "Region") +
  theme_minimal() +
  theme(
    plot.title = element_text(face= "bold", family = "mono", size = 13, hjust= 0.2 ),
    axis.title = element_text(face= "bold", family = "sans", color = "plum"),
    panel.background = element_rect(fill= "black", color = NA),
    plot.background = element_rect(fill= "lavender", color = NA)
  )

ggplotly(p2)
```

```{r}
#| title: "Happiness rates when region is corrupted: less free-will"
p2 <- ggplot(data = Happiness,aes( x =perceptions_of_corruption, y = ladder_score, color= regional_indicator)) +
  geom_point(size= 2.5, alpha= 0.8) +
  geom_smooth (method= "lm",se= FALSE, color= "pink") +
  labs(title = "Influence of corruption perceptions on happiness levels (ladder score)",
       x= "Corruption perception",
       y= "Happiness score",
       color= "Region") +
  theme_minimal() +
  theme(
    plot.title = element_text(face= "bold", family = "mono", size = 13, hjust= 0.2 ),
    axis.title = element_text(face= "bold", family = "sans", color = "plum"),
    panel.background = element_rect(fill= "black", color = NA),
    plot.background = element_rect(fill= "lavender", color = NA)
  )
  
ggplotly(p2)  
```

### Map

```{r}

plot_ly(
  data = Happiness,
  type = "choropleth",
  locations = ~country_name,
  locationmode = "country names",
  z = ~ladder_score,
  colorscale = list(
    c(0, "#f2e5ff"),  
  c(0.5, "#b38aff"),
  c(1, "#5a31f2")   
),
  text = ~paste("Country:", country_name,
                "<br>Score:", ladder_score),
  hoverinfo = "text"

) %>%
  layout(
    title = list( text = "<b>World Happiness Levels (2024)</b>", y= 0.92, 
                  font = list(family = "mono",
                              size = 20,
                              color= "black")),
    geo = list(
      showframe = FALSE,
      showcoastlines = FALSE,
      projection = list(type = "equirectangular"),
      bgcolor= "black"
    ),
    paper_bgcolor = "lavender",               
    plot_bgcolor = "black",
    margin= list(t = 50)
  )


```
